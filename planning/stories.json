{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "project": "jarvis-woodcutter-fps",
  "updatedAt": "2026-02-18T22:37:00Z",
  "statusLegend": {
    "epic": [
      "todo",
      "doing",
      "done"
    ],
    "story": [
      "todo",
      "doing",
      "done"
    ]
  },
  "epics": [
    {
      "id": "P14",
      "title": "Auth v2: guest por dispositivo + login usuário/senha + migração irreversível",
      "status": "doing",
      "objective": "Substituir login por código mágico por autenticação com guest único por dispositivo e conta usuário/senha, permitindo upgrade irreversível de guest para conta.",
      "stories": [
        {
          "id": "P14-S1",
          "title": "Modelo de dados Auth v2",
          "status": "doing",
          "objective": "Criar tabelas users/devices/device_guest_links e preparar compatibilidade com estado atual baseado em guestId.",
          "acceptanceCriteria": [
            "Username único case-insensitive.",
            "Device key única por equipamento.",
            "Vínculo device->guest único com marcação de migração.",
            "Sem quebra de compatibilidade do gameplay atual."
          ],
          "updatedAt": "2026-02-18T22:28:00Z"
        },
        {
          "id": "P14-S2",
          "title": "Endpoint guest por dispositivo",
          "status": "doing",
          "objective": "Criar endpoint para garantir guest único por device e bloquear guest quando já migrado para conta.",
          "acceptanceCriteria": [
            "Mesmo device retorna mesmo guest ativo.",
            "Device com guest migrado retorna erro orientando login por usuário/senha.",
            "Fluxo preserva worldId e token de sessão."
          ],
          "updatedAt": "2026-02-18T22:28:00Z"
        },
        {
          "id": "P14-S3",
          "title": "Cadastro e login por usuário/senha",
          "status": "doing",
          "objective": "Implementar register/login com hash de senha seguro e retorno de sessão compatível.",
          "acceptanceCriteria": [
            "Cadastro com username único e senha mínima.",
            "Login com verificação de hash e erro genérico em credenciais inválidas.",
            "Resposta inclui guestId/token para compatibilidade atual."
          ],
          "updatedAt": "2026-02-18T22:28:00Z"
        },
        {
          "id": "P14-S4",
          "title": "Upgrade guest -> conta (irreversível)",
          "status": "todo",
          "objective": "Permitir que sessão guest vire conta usuário/senha, desativando acesso guest do device.",
          "acceptanceCriteria": [
            "Upgrade associa guest existente a usuário.",
            "Após upgrade, acesso por guest do mesmo device é bloqueado.",
            "Progresso permanece no guest vinculado (compatibilidade)."
          ],
          "updatedAt": "2026-02-18T22:28:00Z"
        },
        {
          "id": "P14-S5",
          "title": "Client UI/fluxo novo",
          "status": "doing",
          "objective": "Atualizar telas para login usuário/senha + entrar como guest + vincular conta quando guest.",
          "acceptanceCriteria": [
            "Tela inicial separa Entrar, Cadastrar e Guest.",
            "Guest logado consegue vincular usuário/senha.",
            "Remover dependência do fluxo de código mágico."
          ],
          "updatedAt": "2026-02-18T22:28:00Z"
        },
        {
          "id": "P14-S6",
          "title": "Hardening e migração",
          "status": "doing",
          "objective": "Adicionar rate-limit e plano de migração/descontinuação do auth antigo.",
          "acceptanceCriteria": [
            "Rate limit mínimo em register/login/guest ensure.",
            "Plano de desligamento de rotas antigas documentado.",
            "Testes de regressão dos fluxos críticos."
          ],
          "updatedAt": "2026-02-18T22:28:00Z"
        }
      ],
      "updatedAt": "2026-02-18T22:37:00Z"
    }
  ]
}
