{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "project": "jarvis-woodcutter-fps",
  "updatedAt": "2026-02-17T13:05:00Z",
  "statusLegend": {
    "epic": ["todo", "doing", "done"],
    "story": ["todo", "doing", "done"]
  },
  "epics": [
    {
      "id": "P5",
      "title": "Storage pessoal + arbustos + agricultura (algodão/fibra/corda)",
      "status": "doing",
      "stories": [
        {
          "id": "P5-S1",
          "title": "Baú pessoal: craft + colocar + abrir só o dono + recolher/destruir só vazio",
          "status": "done",
          "objective": "Adicionar um baú colocável para o jogador guardar itens, com acesso exclusivo do dono.",
          "description": "Criar um novo item/estrutura 'Baú'. O jogador crafta e coloca no mundo. Cada baú nasce com um ownerId (player/guestId) e só esse owner pode abrir e mover itens. Outros jogadores ao interagir devem ver um feedback simples ('Trancado'). Recolher (pickup) e destruir só é permitido se o baú estiver vazio.",
          "acceptanceCriteria": [
            "Existe receita de craft do baú e ele pode ser colocado no mundo como estrutura.",
            "Ao mirar/interagir, o dono consegue abrir o inventário do baú e mover itens entre inventário <-> baú.",
            "Jogadores não-donos não conseguem abrir nem visualizar o conteúdo (apenas mensagem 'Trancado').",
            "Baú só pode ser recolhido/destruído quando estiver vazio.",
            "Estado do baú persiste no servidor por worldId+chestId (inclui ownerId e slots).",
            "Não há duplicação/perda de itens (operações idempotentes e consistentes)."
          ],
          "technicalDecisions": [
            "Persistência server-side semelhante à forja: tabela/registro por (worldId, chestId) com state { ownerId, slots } + updatedAt.",
            "Autoridade: servidor valida ownerId em GET/PUT do chest state.",
            "O cliente só renderiza UI se GET retornar ok + owner=true; caso contrário exibe toast 'Trancado'.",
            "Pickup/destroy: checar vazio no cliente e no servidor (double-check)."
          ]
        },
        {
          "id": "P5-S2",
          "title": "Arbustos (mato): spawn no mundo + coleta + respawn 2 min + drop de sementes (20%)",
          "status": "done",
          "objective": "Adicionar arbustos no mapa para servir como fonte de sementes de algodão.",
          "description": "Hoje não existe 'mato/arbusto' no mundo. Criar um novo nó de recurso (arbusto) semelhante às árvores: nasce no mundo, o jogador coleta e o arbusto some, depois respawna. O respawn deve ser maior que o da árvore: 2 minutos. Ao coletar, além de leaf, existe 20% de chance de dropar cotton_seed.",
          "acceptanceCriteria": [
            "Arbustos aparecem no mundo em quantidade razoável e com collider/interação consistentes.",
            "Coletar um arbusto remove o arbusto e gera drops; após ~2 min ele respawna.",
            "Ao coletar, sempre dropa leaf (ou drop atual equivalente) e tem 20% de chance de dropar cotton_seed.",
            "Arbustos não geram drops infinitos sem desaparecer (sem exploit).",
            "Persistência/respawn segue o mesmo padrão das árvores (com tempo diferente)."
          ],
          "technicalDecisions": [
            "Reusar padrão de 'resource nodes' (árvores) para placement, raycast e respawn timers.",
            "Manter drop table simples e configurável (chance seed=0.20).",
            "Arbustos não devem spawnar na mina (somente no mundo exterior)."
          ]
        },
        {
          "id": "P5-S3",
          "title": "Agricultura (algodão): enxada de metal + solo arado + plantar + crescer 5–8 min + colher fibra/corda",
          "status": "done",
          "objective": "Criar o loop de agricultura para produzir fibra e corda (base para roupas futuras).",
          "description": "Adicionar a enxada de metal (forjada na mesa) para preparar o solo. Ao usar a enxada no chão, o terreno fica com visual 'arado' e passa a aceitar plantio. Sementes (cotton_seed) podem ser plantadas apenas em solo arado. O crescimento leva 5–8 minutos reais. Ao colher, o jogador recebe fiber (e opcionalmente chance de devolver seed). Adicionar craft de rope a partir de fiber.",
          "acceptanceCriteria": [
            "Existe receita para Enxada de Metal na mesa de craft: 2 iron_ingots + 1 stick.",
            "Usar a enxada no chão cria/ativa um tile/patch de solo arado com visual diferente.",
            "Só é possível plantar cotton_seed em solo arado.",
            "Plantas crescem em 5–8 minutos reais (configurável) e podem ser colhidas ao final.",
            "Colheita gera fiber; existe craft rope = fiber xN (definir N inicial: 3).",
            "Na mina: não é possível arar/plantar (ou é bloqueado explicitamente).",
            "Estado das plantações (solo arado + crescimento) persiste no servidor e suporta catch-up offline (similar à forja)."
          ],
          "technicalDecisions": [
            "Persistir por (worldId, plotId) ou por grid (chunk) dependendo do sistema atual; começar simples (plotId por plant).",
            "Catch-up offline por updatedAt: ao carregar, avançar growth com dt acumulado.",
            "Visual de solo arado pode ser decal simples/mesh plano com textura diferente (sem shader pesado).",
            "Restringir agricultura ao exterior (fora da mina) usando flag de região (inMine) já existente."
          ]
        }
      ]
    }
  ]
}
